)
# Save (NOTE: Changed from ../figures/ to figures/)
ggsave("figures/01_species_comparison_scatter.png", fig1,
width = 8, height = 6, dpi = 300)
cat("✓ Figure 1 saved: figures/01_species_comparison_scatter.png\n")
# ==============================================================================
# FIGURE 2: Body Mass Distribution by Species
# ==============================================================================
fig2 <- ggplot(penguins_clean, aes(x = species, y = body_mass_g, fill = species)) +
geom_boxplot(alpha = 0.7, outlier.shape = 21) +
geom_jitter(width = 0.2, alpha = 0.3, size = 1) +
scale_fill_manual(values = species_colors) +
labs(
title = "Gentoo Penguins Show Significantly Greater Body Mass",
subtitle = paste("n =", nrow(penguins_clean), "individuals"),
x = "Species",
y = "Body Mass (g)"
) +
theme(
plot.title = element_text(face = "bold", size = 14),
legend.position = "none"
)
ggsave("figures/02_body_mass_distribution.png", fig2,
width = 8, height = 6, dpi = 300)
cat("✓ Figure 2 saved: figures/02_body_mass_distribution.png\n")
# ==============================================================================
# FIGURE 3: Correlation Matrix
# ==============================================================================
numeric_vars <- penguins_clean %>%
select(bill_length_mm, bill_depth_mm, flipper_length_mm, body_mass_g)
corr_matrix <- cor(numeric_vars, use = "complete.obs")
png("figures/03_correlation_matrix.png", width = 800, height = 800, res = 150)
corrplot(corr_matrix,
method = "color",
type = "upper",
tl.col = "black",
tl.srt = 45,
addCoef.col = "black",
number.cex = 0.8,
col = colorRampPalette(c("#6D9EC1", "white", "#E46726"))(200),
title = "Correlation Matrix: Penguin Morphometrics",
mar = c(0,0,2,0))
dev.off()
cat("✓ Figure 3 saved: figures/03_correlation_matrix.png\n")
# ==============================================================================
# FIGURE 4: Morphometric Relationships
# ==============================================================================
fig4 <- ggplot(penguins_clean, aes(x = flipper_length_mm, y = body_mass_g, color = species)) +
geom_point(size = 2.5, alpha = 0.7) +
geom_smooth(method = "lm", se = TRUE, alpha = 0.2) +
scale_color_manual(values = species_colors) +
labs(
title = "Strong Positive Correlation: Flipper Length vs Body Mass",
subtitle = "Linear regression by species",
x = "Flipper Length (mm)",
y = "Body Mass (g)",
color = "Species"
) +
theme(
plot.title = element_text(face = "bold", size = 14),
legend.position = "bottom"
)
ggsave("figures/04_morphometric_relationships.png", fig4,
width = 8, height = 6, dpi = 300)
cat("✓ Figure 4 saved: figures/04_morphometric_relationships.png\n")
# ==============================================================================
# COMPLETION MESSAGE
# ==============================================================================
cat("\n✓ All visualizations complete!\n")
cat("✓ Figures saved to: figures/\n")
cat("\nGenerated figures:\n")
cat("  1. Species comparison scatter plot\n")
cat("  2. Body mass distribution boxplot\n")
cat("  3. Correlation matrix heatmap\n")
cat("  4. Morphometric relationships plot\n")
# Verify files were created
cat("\n=== Files in figures/ folder ===\n")
print(list.files("figures/"))
# ==============================================================================
# END OF SCRIPT
# ==============================================================================
# 1. Run Script 1
source("C:/Users/HP/Documents/01-penguins-biological-data-analysis/scripts/01_data_preparation.R")
# ==============================================================================
# PROJECT: Palmer Penguins Biological Data Analysis
# SCRIPT: 03 - Data Visualizations (FIXED VERSION)
# AUTHOR: Md. Abrar Faiyaj
# DATE: December 2025
# PURPOSE: Create publication-quality figures
# ==============================================================================
# ==============================================================================
# SETUP WORKING DIRECTORY (ADD THIS SECTION!)
# ==============================================================================
# Set working directory to project root
project_path <- "C:/Users/HP/Documents/01-penguins-biological-data-analysis"
setwd(project_path)
# Verify location
cat("Working directory:", getwd(), "\n\n")
# ==============================================================================
# CONTINUE WITH ORIGINAL CODE (but change paths!)
# ==============================================================================
library(tidyverse)
library(corrplot)
# Load cleaned data (NOTE: Changed from ../data/ to data/)
penguins_clean <- read_csv("data/penguins_clean.csv")
# Convert to factors
penguins_clean$species <- factor(penguins_clean$species)
penguins_clean$island <- factor(penguins_clean$island)
penguins_clean$sex <- factor(penguins_clean$sex)
# Set theme
theme_set(theme_minimal(base_size = 12))
# Colors
species_colors <- c("Adelie" = "#FF6B35", "Chinstrap" = "#004E89", "Gentoo" = "#4ECDC4")
# ==============================================================================
# FIGURE 1: Species Comparison - Bill Dimensions
# ==============================================================================
fig1 <- ggplot(penguins_clean, aes(x = bill_length_mm, y = bill_depth_mm, color = species)) +
geom_point(size = 3, alpha = 0.7) +
scale_color_manual(values = species_colors) +
labs(
title = "Bill Morphology Varies Across Penguin Species",
subtitle = "Palmer Archipelago, Antarctica (2007-2009)",
x = "Bill Length (mm)",
y = "Bill Depth (mm)",
color = "Species"
) +
theme(
plot.title = element_text(face = "bold", size = 14),
legend.position = "bottom"
)
# Save (NOTE: Changed from ../figures/ to figures/)
ggsave("figures/01_species_comparison_scatter.png", fig1,
width = 8, height = 6, dpi = 300)
cat("✓ Figure 1 saved: figures/01_species_comparison_scatter.png\n")
# ==============================================================================
# FIGURE 2: Body Mass Distribution by Species
# ==============================================================================
fig2 <- ggplot(penguins_clean, aes(x = species, y = body_mass_g, fill = species)) +
geom_boxplot(alpha = 0.7, outlier.shape = 21) +
geom_jitter(width = 0.2, alpha = 0.3, size = 1) +
scale_fill_manual(values = species_colors) +
labs(
title = "Gentoo Penguins Show Significantly Greater Body Mass",
subtitle = paste("n =", nrow(penguins_clean), "individuals"),
x = "Species",
y = "Body Mass (g)"
) +
theme(
plot.title = element_text(face = "bold", size = 14),
legend.position = "none"
)
ggsave("figures/02_body_mass_distribution.png", fig2,
width = 8, height = 6, dpi = 300)
cat("✓ Figure 2 saved: figures/02_body_mass_distribution.png\n")
# ==============================================================================
# FIGURE 3: Correlation Matrix
# ==============================================================================
numeric_vars <- penguins_clean %>%
select(bill_length_mm, bill_depth_mm, flipper_length_mm, body_mass_g)
corr_matrix <- cor(numeric_vars, use = "complete.obs")
png("figures/03_correlation_matrix.png", width = 800, height = 800, res = 150)
corrplot(corr_matrix,
method = "color",
type = "upper",
tl.col = "black",
tl.srt = 45,
addCoef.col = "black",
number.cex = 0.8,
col = colorRampPalette(c("#6D9EC1", "white", "#E46726"))(200),
title = "Correlation Matrix: Penguin Morphometrics",
mar = c(0,0,2,0))
dev.off()
cat("✓ Figure 3 saved: figures/03_correlation_matrix.png\n")
# ==============================================================================
# FIGURE 4: Morphometric Relationships
# ==============================================================================
fig4 <- ggplot(penguins_clean, aes(x = flipper_length_mm, y = body_mass_g, color = species)) +
geom_point(size = 2.5, alpha = 0.7) +
geom_smooth(method = "lm", se = TRUE, alpha = 0.2) +
scale_color_manual(values = species_colors) +
labs(
title = "Strong Positive Correlation: Flipper Length vs Body Mass",
subtitle = "Linear regression by species",
x = "Flipper Length (mm)",
y = "Body Mass (g)",
color = "Species"
) +
theme(
plot.title = element_text(face = "bold", size = 14),
legend.position = "bottom"
)
ggsave("figures/04_morphometric_relationships.png", fig4,
width = 8, height = 6, dpi = 300)
cat("✓ Figure 4 saved: figures/04_morphometric_relationships.png\n")
# ==============================================================================
# COMPLETION MESSAGE
# ==============================================================================
cat("\n✓ All visualizations complete!\n")
cat("✓ Figures saved to: figures/\n")
cat("\nGenerated figures:\n")
cat("  1. Species comparison scatter plot\n")
cat("  2. Body mass distribution boxplot\n")
cat("  3. Correlation matrix heatmap\n")
cat("  4. Morphometric relationships plot\n")
# Verify files were created
cat("\n=== Files in figures/ folder ===\n")
print(list.files("figures/"))
# ==============================================================================
# END OF SCRIPT
# ==============================================================================
# ==============================================================================
# PROJECT: Palmer Penguins Biological Data Analysis
# SCRIPT: 01 - Data Preparation
# AUTHOR: Md. Abrar Faiyaj
# DATE: 7th December 2025
# PURPOSE: Clean and prepare penguin morphometric data for analysis
# ==============================================================================
# ==============================================================================
# SETUP WORKING DIRECTORY (ADD THIS SECTION!)
# ==============================================================================
# Create project folder if it doesn't exist
project_path <- "C:/Users/HP/Documents/01-penguins-biological-data-analysis"
if (!dir.exists(project_path)) {
dir.create(project_path, recursive = TRUE)
}
# Set working directory to project root
setwd(project_path)
# Verify location
cat("Working directory set to:", getwd(), "\n\n")
# Create subfolders
dir.create("data", showWarnings = FALSE)
dir.create("scripts", showWarnings = FALSE)
dir.create("figures", showWarnings = FALSE)
dir.create("results", showWarnings = FALSE)
dir.create("docs", showWarnings = FALSE)
# ==============================================================================
# NOW CONTINUE WITH ORIGINAL CODE (but change paths!)
# ==============================================================================
# Load required libraries
library(tidyverse)
library(palmerpenguins)
# ==============================================================================
# 1. LOAD RAW DATA
# ==============================================================================
cat("Loading Palmer Penguins dataset...\n")
penguins_raw <- penguins
# Save raw data (NOTE: Changed from ../data/ to data/)
write_csv(penguins_raw, "data/penguins_raw.csv")
# Display basic information
cat("\n=== Dataset Overview ===\n")
cat("Total observations:", nrow(penguins_raw), "\n")
cat("Variables:", ncol(penguins_raw), "\n")
cat("Species:", paste(unique(penguins_raw$species), collapse = ", "), "\n")
# ==============================================================================
# 2. DATA INSPECTION
# ==============================================================================
cat("\n=== Missing Values ===\n")
missing_summary <- penguins_raw %>%
summarise(across(everything(), ~sum(is.na(.)))) %>%
pivot_longer(everything(), names_to = "variable", values_to = "n_missing") %>%
filter(n_missing > 0)
print(missing_summary)
# ==============================================================================
# 3. DATA CLEANING
# ==============================================================================
cat("\n=== Cleaning Data ===\n")
penguins_clean <- penguins_raw %>%
drop_na()
# Convert to factors
penguins_clean$species <- factor(penguins_clean$species)
penguins_clean$island <- factor(penguins_clean$island)
penguins_clean$sex <- factor(penguins_clean$sex)
cat("Observations after cleaning:", nrow(penguins_clean), "\n")
cat("Removed:", nrow(penguins_raw) - nrow(penguins_clean), "incomplete rows\n")
# ==============================================================================
# 4. DATA VALIDATION
# ==============================================================================
cat("\n=== Data Validation ===\n")
cat("Bill length (mm):", min(penguins_clean$bill_length_mm), "-",
max(penguins_clean$bill_length_mm), "\n")
cat("Bill depth (mm):", min(penguins_clean$bill_depth_mm), "-",
max(penguins_clean$bill_depth_mm), "\n")
cat("Flipper length (mm):", min(penguins_clean$flipper_length_mm), "-",
max(penguins_clean$flipper_length_mm), "\n")
cat("Body mass (g):", min(penguins_clean$body_mass_g), "-",
max(penguins_clean$body_mass_g), "\n")
# ==============================================================================
# 5. SAVE CLEANED DATA
# ==============================================================================
# Save (NOTE: Changed from ../data/ to data/)
write_csv(penguins_clean, "data/penguins_clean.csv")
cat("\n✓ Data preparation complete!\n")
cat("✓ Cleaned data saved to: data/penguins_clean.csv\n")
# ==============================================================================
# END OF SCRIPT
# ==============================================================================
# ==============================================================================
# PROJECT: Palmer Penguins Biological Data Analysis
# SCRIPT: 02 - Exploratory Data Analysis
# AUTHOR: Md. Abrar Faiyaj
# DATE: 7th December 2025
# PURPOSE: Statistical analysis and hypothesis testing
# ==============================================================================
# ==============================================================================
# SETUP WORKING DIRECTORY (ADD THIS SECTION!)
# ==============================================================================
# Set working directory to project root
project_path <- "C:/Users/HP/Documents/01-penguins-biological-data-analysis"
setwd(project_path)
# Verify location
cat("Working directory:", getwd(), "\n\n")
# ==============================================================================
# CONTINUE WITH ORIGINAL CODE (but change paths!)
# ==============================================================================
library(tidyverse)
library(broom)
# Load cleaned data (NOTE: Changed from ../data/ to data/)
penguins_clean <- read_csv("data/penguins_clean.csv")
# Convert to factors
penguins_clean$species <- factor(penguins_clean$species)
penguins_clean$island <- factor(penguins_clean$island)
penguins_clean$sex <- factor(penguins_clean$sex)
# ==============================================================================
# 1. SUMMARY STATISTICS BY SPECIES
# ==============================================================================
cat("=== Summary Statistics by Species ===\n\n")
summary_stats <- penguins_clean %>%
group_by(species) %>%
summarise(
n = n(),
mean_body_mass = mean(body_mass_g, na.rm = TRUE),
sd_body_mass = sd(body_mass_g, na.rm = TRUE),
mean_flipper_length = mean(flipper_length_mm, na.rm = TRUE),
sd_flipper_length = sd(flipper_length_mm, na.rm = TRUE),
mean_bill_length = mean(bill_length_mm, na.rm = TRUE),
sd_bill_length = sd(bill_length_mm, na.rm = TRUE),
mean_bill_depth = mean(bill_depth_mm, na.rm = TRUE),
sd_bill_depth = sd(bill_depth_mm, na.rm = TRUE)
) %>%
mutate(across(where(is.numeric), ~round(., 1)))
print(summary_stats)
# Save (NOTE: Changed from ../results/ to results/)
write_csv(summary_stats, "results/summary_statistics.csv")
# ==============================================================================
# 2. STATISTICAL TESTING
# ==============================================================================
cat("\n=== Statistical Tests ===\n\n")
# ANOVA: Body mass differences between species
anova_body_mass <- aov(body_mass_g ~ species, data = penguins_clean)
anova_summary <- tidy(anova_body_mass)
cat("ANOVA: Body Mass by Species\n")
print(anova_summary)
# Post-hoc test
tukey_result <- TukeyHSD(anova_body_mass)
cat("\nPost-hoc Tukey HSD:\n")
print(tukey_result)
# ==============================================================================
# 3. CORRELATION ANALYSIS
# ==============================================================================
cat("\n=== Correlation Analysis ===\n\n")
numeric_vars <- penguins_clean %>%
select(bill_length_mm, bill_depth_mm, flipper_length_mm, body_mass_g)
correlation_matrix <- cor(numeric_vars, use = "complete.obs")
cat("Correlation Matrix:\n")
print(round(correlation_matrix, 2))
# ==============================================================================
# 4. SAVE STATISTICAL RESULTS
# ==============================================================================
statistical_results <- paste(
"=== STATISTICAL ANALYSIS RESULTS ===\n",
"\nANOVA: Body Mass by Species\n",
paste(capture.output(print(anova_summary)), collapse = "\n"),
"\n\nPost-hoc Tukey HSD:\n",
paste(capture.output(print(tukey_result)), collapse = "\n"),
"\n\nCorrelation Matrix:\n",
paste(capture.output(print(round(correlation_matrix, 2))), collapse = "\n"),
sep = "\n"
)
# Save (NOTE: Changed from ../results/ to results/)
writeLines(statistical_results, "results/statistical_tests.txt")
cat("\n✓ Exploratory analysis complete!\n")
cat("✓ Results saved to: results/\n")
# ==============================================================================
# END OF SCRIPT
# ==============================================================================
# ==============================================================================
# PROJECT: Palmer Penguins Biological Data Analysis
# SCRIPT: 03 - Data Visualizations
# AUTHOR: Md. Abrar Faiyaj
# DATE: 7th December 2025
# PURPOSE: Create publication-quality figures
# ==============================================================================
# ==============================================================================
# SETUP WORKING DIRECTORY (ADD THIS SECTION!)
# ==============================================================================
# Set working directory to project root
project_path <- "C:/Users/HP/Documents/01-penguins-biological-data-analysis"
setwd(project_path)
# Verify location
cat("Working directory:", getwd(), "\n\n")
# ==============================================================================
# CONTINUE WITH ORIGINAL CODE (but change paths!)
# ==============================================================================
library(tidyverse)
library(corrplot)
# Load cleaned data (NOTE: Changed from ../data/ to data/)
penguins_clean <- read_csv("data/penguins_clean.csv")
# Convert to factors
penguins_clean$species <- factor(penguins_clean$species)
penguins_clean$island <- factor(penguins_clean$island)
penguins_clean$sex <- factor(penguins_clean$sex)
# Set theme
theme_set(theme_minimal(base_size = 12))
# Colors
species_colors <- c("Adelie" = "#FF6B35", "Chinstrap" = "#004E89", "Gentoo" = "#4ECDC4")
# ==============================================================================
# FIGURE 1: Species Comparison - Bill Dimensions
# ==============================================================================
fig1 <- ggplot(penguins_clean, aes(x = bill_length_mm, y = bill_depth_mm, color = species)) +
geom_point(size = 3, alpha = 0.7) +
scale_color_manual(values = species_colors) +
labs(
title = "Bill Morphology Varies Across Penguin Species",
subtitle = "Palmer Archipelago, Antarctica (2007-2009)",
x = "Bill Length (mm)",
y = "Bill Depth (mm)",
color = "Species"
) +
theme(
plot.title = element_text(face = "bold", size = 14),
legend.position = "bottom"
)
# Save (NOTE: Changed from ../figures/ to figures/)
ggsave("figures/01_species_comparison_scatter.png", fig1,
width = 8, height = 6, dpi = 300)
cat("✓ Figure 1 saved: figures/01_species_comparison_scatter.png\n")
# ==============================================================================
# FIGURE 2: Body Mass Distribution by Species
# ==============================================================================
fig2 <- ggplot(penguins_clean, aes(x = species, y = body_mass_g, fill = species)) +
geom_boxplot(alpha = 0.7, outlier.shape = 21) +
geom_jitter(width = 0.2, alpha = 0.3, size = 1) +
scale_fill_manual(values = species_colors) +
labs(
title = "Gentoo Penguins Show Significantly Greater Body Mass",
subtitle = paste("n =", nrow(penguins_clean), "individuals"),
x = "Species",
y = "Body Mass (g)"
) +
theme(
plot.title = element_text(face = "bold", size = 14),
legend.position = "none"
)
ggsave("figures/02_body_mass_distribution.png", fig2,
width = 8, height = 6, dpi = 300)
cat("✓ Figure 2 saved: figures/02_body_mass_distribution.png\n")
# ==============================================================================
# FIGURE 3: Correlation Matrix
# ==============================================================================
numeric_vars <- penguins_clean %>%
select(bill_length_mm, bill_depth_mm, flipper_length_mm, body_mass_g)
corr_matrix <- cor(numeric_vars, use = "complete.obs")
png("figures/03_correlation_matrix.png", width = 800, height = 800, res = 150)
corrplot(corr_matrix,
method = "color",
type = "upper",
tl.col = "black",
tl.srt = 45,
addCoef.col = "black",
number.cex = 0.8,
col = colorRampPalette(c("#6D9EC1", "white", "#E46726"))(200),
title = "Correlation Matrix: Penguin Morphometrics",
mar = c(0,0,2,0))
dev.off()
cat("✓ Figure 3 saved: figures/03_correlation_matrix.png\n")
# ==============================================================================
# FIGURE 4: Morphometric Relationships
# ==============================================================================
fig4 <- ggplot(penguins_clean, aes(x = flipper_length_mm, y = body_mass_g, color = species)) +
geom_point(size = 2.5, alpha = 0.7) +
geom_smooth(method = "lm", se = TRUE, alpha = 0.2) +
scale_color_manual(values = species_colors) +
labs(
title = "Strong Positive Correlation: Flipper Length vs Body Mass",
subtitle = "Linear regression by species",
x = "Flipper Length (mm)",
y = "Body Mass (g)",
color = "Species"
) +
theme(
plot.title = element_text(face = "bold", size = 14),
legend.position = "bottom"
)
ggsave("figures/04_morphometric_relationships.png", fig4,
width = 8, height = 6, dpi = 300)
cat("✓ Figure 4 saved: figures/04_morphometric_relationships.png\n")
# ==============================================================================
# COMPLETION MESSAGE
# ==============================================================================
cat("\n✓ All visualizations complete!\n")
cat("✓ Figures saved to: figures/\n")
cat("\nGenerated figures:\n")
cat("  1. Species comparison scatter plot\n")
cat("  2. Body mass distribution boxplot\n")
cat("  3. Correlation matrix heatmap\n")
cat("  4. Morphometric relationships plot\n")
# Verify files were created
cat("\n=== Files in figures/ folder ===\n")
print(list.files("figures/"))
# ==============================================================================
# END OF SCRIPT
# ==============================================================================
